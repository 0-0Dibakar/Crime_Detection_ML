# Crime_Detection_ML
Developing a machine learning model for crime detection is a complex task that requires expertise in both machine learning and criminology.

**Introduction:-**
With the increasing activities of crime throughout the country and world, it has become a very serious issue for authorities as well as people. Also continuous monitoring of the public places and automatic detection and intimation of crime activities in public places is a challenge to improve the standard of public safety and security. Video surveillance systems are affordable and have been used everywhere nowadays. The human monitoring of multiple video surveillance channels simultaneously is found to be costly, time-consuming, more prone to error, and ineffective as the number of channels increases. Hence, a lot of attention has been put on the development of the intelligent surveillance system by both academia and industries. 

The conventional or traditional methods based on manual feature extraction do not effectively detect human crime events across various application domains due to poor feature representation. There are some existing approaches based on sparse representation for identifying crime or anomalous activities. The underlying assumption in this sparse representation-based model is anomalous motion patterns that can’t be represented by the models trained on the normal motion patterns. However, there is a thin line of distinction between normal and anomalous events for particular crime activities (context-specific). Hence, deep-learning methods have been preferred as compared to traditional machine learning methods due to the high accuracy of anomaly detection, the ability of generalization across multiple datasets with the help of transfer learning and automatic feature representations. Most of the current video-based anomaly detection systems have not utilized the benefits of the hierarchical feature learning ability of the deep learning approach to its full potential. Hence, there is a need for more intensive researches to analyze the ability of the deep-learning-based video anomaly detection methods in fully automatic frameworks. 

**Objectives:-**
The objective of the CD module is to develop an intelligent video surveillance system which automatically detects the crime activities such as loitering, intrusion, fighting, etc. and intimate the concerned authorities like police in real-time. The system first detects a video anomaly, then classify the anomalous or crime events such as abuse, arrest, arson, assault, burglary, clash, explosion, fell-down, fighting, illegal U-turn, kidnap, loitering, panic, road accident, robbery, shooting, murder, wrong way, shoplifting, stealing, trespassing, vandalism and recognizes the weapons used such as gun, pistol, knife, bow with an arrow, cannon, tank, missile, bomb, lathi, and sword. Finally, the system automatically intimates the concerned authorities for taking necessary actions. 

Further, the main objective of the CD module can be segregated into the following sub-objectives.
•	To develop a video-based intrusion detection system.
•	To develop a video-based loitering detection system.
•	To develop a video anomaly detection system.
•	To develop a crime activity classification system.
•	To develop a weapon detection system.

**System Model:-**
The system model of the CD module with its potential application can be represented as shown in Fig. 1. Here, system can be operated both in edge computing configuration (standalone setup) or in hybrid computing configuration, i.e., a combination of edge and fog computations. In case of only edge computing mode of configuration, time latency is minimized, however, only few less computational task can be performed. On the other hand, in case of hybrid computing configuration, the real-time video streams are fed from the fixed surveillance camera network to the edge computing device through high bandwidth wired connection. Further, the fixed surveillance camera network can be consisting of ‘n’ number of network cameras for the corresponding ‘n’ number of camera views, respectively. Here, due to the computational capacity constraint of the edge device, practically ‘n’ should be limited to a finite number depending on the computational constraints. After processing of the video streams for the anomaly detection at the edge device, the complex computations such as detailed crime event analysis is performed at the fog server or local server and stored at the fog database, and the processed information will be sent to the cloud database unit through gateway using Wi-Fi link. Subsequently, real-time alert messages or notification can be sent to the mobile phones of the concerned authorities such as police, law enforcing agencies, etc. to take necessary actions. 	Methodology:-
In this section, the methodologies involved in the development of the various submodules of the CD module with the important results are briefly presented. 

**Development of the intrusion detection system:-**
There is a huge demand of video surveillance based intelligent security systems which can automatically detect the unauthorized entry or mal-intentional intrusion to the unattended sensitive areas and notify to the concerned authorities in real-time. A novel video-based Intrusion Detection System (IDS) using deep learning is proposed. Here, You Only Look Once (YOLO) algorithm is used for object detection and intrusion is decided using our proposed algorithm based on the shifted center of mass of the detected object. Further, Simple Online and Real-time Tracking (SORT) algorithm is used for the tracking of the intruder in real-time. The developed system is also implemented and tested for live video stream using NVIDIA Jetson TX2 development platform with an accuracy of 97% and average fps of 30. Here, the proposed IDS is a generic one where the user can select the region of interest (the area to be intrusion free) of any size and shape from the reference (starting) frame and potential intruders such as a person, vehicle, etc. from the list of trained object classes. Hence, it can have a wide range of smart city applications such as person intrusion free zone, no vehicle entry zone, no parking zone, smart home security, etc. The developed GUI is shown in Fig. 2. Few important field trial results are shown in Fig. 3. Only when the person enters to the RoI, intrusion is detected, otherwise no intrusion is detected.   The real time notification about the intrusion is sent to the registered user as 
Development of the loitering detection system over multi-camera surveillance network:-
A deep-learning-based Loitering Detection System (LDS) with re-identification (ReID) capability over a multicamera network is proposed. The proposed LDS is mainly comprising of object detection and tracking, loitering detection, feature extraction, camera switching, and re-identification of the loiterer. The person is detected using You Only Look Once (YOLOv3) and tracked using Simple Online Real-time Tracking with a deep association matrix (DeepSORT). From the trajectory analysis, once the time and displacements thresholds are satisfied, the person is treated as a loiterer. When the loiterer moves one camera to another, then the algorithm is switched to the appropriate camera feed as per the proposed camera switching algorithm to minimize the computational cost. Subsequently, the loiterer is reidentified in the switched camera  minimize the computational cost. Subsequently, the loiterer is reidentified in the  switched camera feed by comparing the features of the loiterer extracted by the MobileNets with that of the other detected persons based on the triplet loss criteria. The proposed system provides an enhanced accuracy of 96 % on average fps of 33 (without ReID) and 81.5 % at average fps of 30 (with ReID). The developed GUI, field trial results and real-time notifications .

**Development of the video anomaly detection system:-**
An improved Deep Spatiotemporal Model using convolutional spatiotemporal autoencoder is used for video anomaly detection. The proposed model architecture comprises three major sections: spatial encoder, temporal encoder-decoder, and spatial decoder. The spatial encoder is implemented using three layers of the convolutional layers. Then, the temporal encoder-decoder is realized with the help of Convolutional Long Short Term Memory (ConvLSTM), gated with the tanh and sigmoid activation functions. Finally, the spatial decoder is implemented using three layers of deconvolutional layers. The proposed model is trained only on the dataset that comprises the normal classes by minimizing the reconstruction error. Later, when the trained model is tested using the test dataset susceptible to containing anomalous activities, then a high reconstruction error has resulted. Subsequently, a high anomaly score and low regularity score have resulted. When the regularity score of the frames falls below the set threshold level, then the corresponding frames are treated as anomalous ones. Further, the anomaly is spatiotemporally localized by the fusion of both spatial and temporal features. The detected and localized video anomaly is visualized in feature space using GRAD-CAM++. The proposed model is trained and tested on UCSD Pedestrian datasets and CUHK Avenue dataset successfully. The results of the performance evaluation are found to be promising. Regularity score and detection of the anomalous frame with thresholding operation for UCSD Pedestrian dataset are shown in Fig. 9. 


**Development of the crime activity classification system:-**
The anomalous frame sequences are preprocessed to get the frames with the required spatiotemporal resolution. Then, these frames are provided to the spatiotemporal deep neural network-based activity recognition model to classify the anomalous activities in terms of trained class-specific confidence level. The spatiotemporal deep neural network-based activity recognition model is implemented by an improved deep neural network comprises of the Dense Convolutional Network (DenseNet) and Long-Short-Term-Memory (LSTM).  Here, AdaBound, which employs dynamic bounds on learning rates to achieve an optimized level of accuracy as well as training speed, is used. The trained classes for the developed models includes twenty-two types of anomalous activities such as abuse, arrest, arson, assault, burglary, clash, explosion, fell-down, fighting, illegal U-turn, kidnap, loitering, panic, road accident, robbery, shooting, murder, wrong way, shoplifting, stealing, trespassing, vandalism. If the anomalous activity is classified successfully, then the analyzed information such as activity name corresponding to the video segment is stored in the database. If the anomalous activity is not successfully classified, i.e., the class-specific classification confidence is low, then the process is maintained continuously.  The achieved detection average accuracy is 88.23% from end to end pipeline.\

**Development of the weapon detection system:-**
The anomalous frame sequences are preprocessed to get the frames with the required spatiotemporal resolution. Then, these frames are provided to the deep neural network model for weapon recognition. The deep neural network model for weapon recognition is implemented using an improved model using YOLOv5 architecture is devolved to recognize the weapons used in the anomalous activity. Here, the model is trained with eleven classes of weapons such as axe, gun, pistol, knife, bow with an arrow, cannon, tank, missile, bomb, lathi, and sword. The method checks, “Is weapon detected?” continuously for the anomalous frames. If weapons are not recognized, then the algorithm maintains continuity. When weapons are recognized, then the classified frames containing weapons are sorted in descending order according to the class-specific confidence levels. The classification results for the weapon recognition with individual highest classification accuracy are stored in the database. The average accuracy of the weapon recognition using normal surveillance is approximately 81 %. Few important experimental results of the developed weapon detetion system are presented in Fig. 10 - Fig. 17

**Summary:-**
The devolped intelligent video surveillance system detects crime activities using the video for real-time applications and also intimates the concerned authorities in near-real time. The system is cap able of operating either in edge computing mode or in hybrid mode of computation depending upon the required applications. Intially, the system detects a video anomaly, i.e., unexpected patterns or rarely occurring events, wherein its confidence level will be defined by the anomaly score; then, there is crime event classification and  recognition of weapons used in the crime incident are performed, wherein a deep learning-based highly computationally heavy process is executed only for the anomalous frames corresponding to the video anomaly instead of all the frames. This results in an effcienient and robust end-to-end pipleline for complete crime scene analysis. Hence, the system provides a video surveillance-based economical crime alert system which can reduce the impact of crime in real-time. 






![CD Module](https://github.com/0-0Dibakar/Crime_Detection_ML/assets/106139442/77f3b0b4-5400-4632-9e72-e583c7c68c68)




